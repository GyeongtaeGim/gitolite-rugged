<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Gitolite-rugged by jbox-web</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Gitolite-rugged</h1>
        <p>A Ruby interface for the Gitolite Git backend system</p>

        <p class="view"><a href="https://github.com/jbox-web/gitolite-rugged">View the Project on GitHub <small>jbox-web/gitolite-rugged</small></a></p>


        <ul>
          <li><a href="https://github.com/jbox-web/gitolite-rugged/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/jbox-web/gitolite-rugged/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/jbox-web/gitolite-rugged">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h2>
<a id="gitolite-rugged" class="anchor" href="#gitolite-rugged" aria-hidden="true"><span class="octicon octicon-link"></span></a>gitolite-rugged</h2>

<p><a href="https://travis-ci.org/jbox-web/gitolite-rugged"><img src="https://travis-ci.org/jbox-web/gitolite-rugged.svg?branch=devel" alt="Build Status"></a>
<a href="https://codeclimate.com/github/jbox-web/gitolite-rugged"><img src="https://codeclimate.com/github/jbox-web/gitolite-rugged/badges/gpa.svg" alt="Code Climate"></a>
<a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=FBT7E7DAVVEEU"><img src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" alt="Donate"></a></p>

<h3>
<a id="this-gem-is-a-fork-from-the-jbox-gitolite-gem-employing-libgit2rugged" class="anchor" href="#this-gem-is-a-fork-from-the-jbox-gitolite-gem-employing-libgit2rugged" aria-hidden="true"><span class="octicon octicon-link"></span></a>This gem is a fork from the <a href="https://github.com/jbox-web/gitolite">jbox-gitolite</a> gem employing <a href="https://github.com/libgit2/rugged">libgit2/rugged</a>.</h3>

<p>This gem is designed to provide a Ruby interface to the <a href="https://github.com/sitaramc/gitolite">Gitolite</a> Git backend system.</p>

<p>It provides these functionalities :</p>

<ul>
<li>SSH Public Keys Management</li>
<li>Repositories Management</li>
<li>Gitolite Admin Repository Bootstrapping</li>
</ul>

<h2>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h2>

<ul>
<li>Ruby 1.9.x or 2.0.x</li>
<li>a working <a href="https://github.com/sitaramc/gitolite">gitolite</a> installation</li>
<li>The <a href="https://github.com/libgit2/rugged">rugged</a> bindings to libgit2 with SSH-key credentials added (Version &gt;= 0.21 or dev branch).</li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Put this in your <code>Gemfile</code> :</p>

<pre><code>gem 'gitolite-rugged', git: 'https://github.com/jbox-web/gitolite-rugged.git', branch: 'v1.0.0'
</code></pre>

<p>then</p>

<pre><code>bundle install
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="bootstrapping-the-gitolite-admingit-repository" class="anchor" href="#bootstrapping-the-gitolite-admingit-repository" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bootstrapping the gitolite-admin.git repository</h3>

<p>You can have <code>gitolite-rugged</code> clone the repository for you on demand, however I would recommend cloning it manually.
See it as a basic check that your gitolite installation was correctly set up.</p>

<p>In both cases, use the following code to create an instance of the manager:</p>

<pre><code>settings = { :public_key =&gt; '~/.ssh/id_rsa.pub', :private_key =&gt; '~/.ssh/id_rsa' }
admin = Gitolite::GitoliteAdmin.new('/home/myuser/gitolite-admin', settings)
</code></pre>

<p>For cloning and pushing to the gitolite-admin.git, you have to provide several options to <code>GitoliteAdmin</code> in the settings hash. The following keys are used.</p>

<ul>
<li>
<strong>:git_user</strong> The git user to SSH to (:git_user@localhost:gitolite-admin.git), defaults to 'git'</li>
<li>
<strong>:host</strong> Hostname for clone url. Defaults to 'localhost'</li>
<li>
<strong>:private_key</strong> The key file containing the private SSH key for :git_user</li>
<li>
<strong>:public_key</strong> The key file containing the public SSH key for :git_user</li>
<li>
<strong>:author_name:</strong> The git author name to commit with (default: 'gitolite-rugged gem')</li>
<li>
<strong>:author_email</strong> The git author e-mail address to commit with (default: 'gitolite-rugged@localhost')</li>
<li>
<strong>:commit_msg</strong> The commit message to use when updating the repo (default: 'Commited by the gitolite-rugged gem')</li>
</ul>

<h3>
<a id="managing-public-keys" class="anchor" href="#managing-public-keys" aria-hidden="true"><span class="octicon octicon-link"></span></a>Managing Public Keys</h3>

<p>To add a key, create a <code>SSHKey</code> object and use the <code>add_key(key)</code> method of GitoliteAdmin.</p>

<pre><code># From filesystem
key_from_file = SSHKey.from_file("/home/alice/.ssh/id_rsa.pub")

# From String, which requires us to add an owner manually
key_from_string = SSHKey.from_string('ssh-rsa AAAAB3N/* .... */JjZ5SgfIKab bob@localhost', 'bob')

admin.add_key(key_from_string)
admin.add_key(key_from_file)
</code></pre>

<p>Note that you can add a <em>location</em> using the syntax described in <a href="http://gitolite.com/gitolite/users.html#old-style-multi-keys">the Gitolite documentation</a>.</p>

<p>To write out the changes to the keys to the filesystem and push them to gitolite, call <code>admin.save_and_apply</code>.
You can also manually call <code>admin.save</code> to commit the changes locally, but not push them.</p>

<h3>
<a id="managing-repositories" class="anchor" href="#managing-repositories" aria-hidden="true"><span class="octicon octicon-link"></span></a>Managing Repositories</h3>

<p>To add a new repository, we first create and configure it, and then add it to the memory representation of gitolite:</p>

<pre><code>repo = Gitolite::Config::Repo.new('foobar')
repo.add_permission("RW+", "alice", "bob")

# Add the repo
admin.config.add_repo(repo)
</code></pre>

<p>To remove a repository called 'foobar', execute <code>config.rm_repo('foobar')</code>.</p>

<h3>
<a id="groups" class="anchor" href="#groups" aria-hidden="true"><span class="octicon octicon-link"></span></a>Groups</h3>

<p>As in the <a href="http://gitolite.com/gitolite/groups.html">Gitolite Config</a> you can define groups as an alias to repos or users.</p>

<pre><code># Creating a group
devs = Gitolite::Config::Group.new('developers')
devs.add_users("alice", "bob")

# Adding a group to config
admin.config.add_group(devs)
</code></pre>

<h2>
<a id="copyrights--license" class="anchor" href="#copyrights--license" aria-hidden="true"><span class="octicon octicon-link"></span></a>Copyrights &amp; License</h2>

<p>gitolite-rugged is completely free and open source and released under the <a href="https://github.com/oliverguenther/gitolite/blob/devel/LICENSE.txt">MIT License</a>.</p>

<p>Copyright (c) 2015 Nicolas Rodriguez (<a href="mailto:nrodriguez@jbox-web.com">nrodriguez@jbox-web.com</a>), JBox Web (<a href="http://www.jbox-web.com">http://www.jbox-web.com</a>)</p>

<p>Copyright (c) 2014 Oliver GÃ¼nther (<a href="mailto:mail@oliverguenther.de">mail@oliverguenther.de</a>)</p>

<p>Based on the jbox-gitolite fork by Nicolas Rodriguez, which itself is based on the original gitolite gem by Stafford Brunk.</p>

<p>Copyright (c) 2013-2014 Nicolas Rodriguez (<a href="mailto:nrodriguez@jbox-web.com">nrodriguez@jbox-web.com</a>), JBox Web (<a href="http://www.jbox-web.com">http://www.jbox-web.com</a>)</p>

<p>Copyright (c) 2011-2013 Stafford Brunk (<a href="mailto:stafford.brunk@gmail.com">stafford.brunk@gmail.com</a>)</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/jbox-web">jbox-web</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-36504891-3");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>